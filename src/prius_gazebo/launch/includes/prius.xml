<?xml version="1.0"?>
<launch>

  <arg name="init_pose"/>
  <arg name="robot_name"/>

<!-- Generation of racecar and detectors: camera, lidar, zed -->
  <!-- Convert an xacro and put on parameter server -->

  <param name="robot_description" 
      command="$(find xacro)/xacro --inorder $(find prius_description)/urdf/prius.urdf" />


  <!-- Spawn a robot into Gazebo -->
  <node name="spawn_$(arg robot_name)_urdf" pkg="gazebo_ros" type="spawn_model" output="screen" args="-param robot_description -urdf $(arg init_pose) -model $(arg robot_name) " />
  <!-- ros_control racecar launch file -->
  <include file="$(find prius_control)/launch/prius_control.launch" >
    <arg name="robot_ns" value="$(arg robot_name)" />
  </include>
  
  <!-- Publish "better odom" topic that is normally generated by the particle filter -->
  <node name="better_odom" pkg="topic_tools" type="relay" args="/vesc/odom /pf/pose/odom" /> 

  <!--rf2o_Laser_Odometry-->
  <include file="$(find solabot_navigation)/launch/includes/simulator/racecar_rf2o.xml" />

  <!-- ekf odom_fusion --> 
  <node pkg="robot_localization" type="ekf_localization_node" name="ekf_se" clear_params="true" >
    <rosparam command="load" file="$(find solabot_navigation)/params/simulator/racecar_ekf_params.yaml" />
  </node>

</launch>
